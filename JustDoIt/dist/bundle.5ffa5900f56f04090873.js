(()=>{"use strict";const t=document.getElementById("modal"),e=document.getElementById("todo-form"),n=t.querySelector("h2"),i=e.querySelector("#todo-form-title"),o=e.querySelector("#todo-form-description"),s=e.querySelector("#todo-form-icon"),r=e.querySelector("button");function l(e){e.preventDefault(),m.Instance.Add(new u(i.value,o.value,+s.value)),t.style.display="none"}const c=document.getElementById("todo-container"),d=document.getElementById("todo-item-template");let a=class{constructor(t,e,n,i){this._id=null!=i?i:m.Instance.GenerateId(),this._title=t,this._description=e,this._toDoType=n}get Id(){return this._id}set Id(t){this._id=t}get Title(){return this._title}set Title(t){if(t.length<3||t.length>64)throw new Error("Title has to be minimum 3 characters long and maximum 64 characters long.");this._title=t}get Description(){return this._description}set Description(t){if(t.length>256)throw new Error("Description has to be maximum 256 characters long.");this._description=t}get ToDoType(){return this._toDoType}set ToDoType(t){this._toDoType=t}};a=function(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r}([function(s){return class extends s{constructor(...s){var a;super(...s);const u=d.content.cloneNode(!0);this._id=null!==(a=s[3])&&void 0!==a?a:m.Instance.GenerateId(),this._imageElement=u.querySelector(".todo-item-icon"),this._titleElement=u.querySelector(".todo-item-details_title"),this._descriptionElement=u.querySelector(".todo-item-details_description"),this.SetData(s[0],s[1],s[2]),u.querySelector(".edit-btn").addEventListener("click",(()=>{return s=this,c=void 0,a=function*(){const s=yield function(s){return c=this,d=void 0,u=function*(){return n.textContent="Edit Task",r.textContent="Edit",e.removeEventListener("submit",l),new Promise(((n,r)=>{e.addEventListener("submit",(i=>{i.preventDefault();try{n(new FormData(e))}catch(t){r(null)}finally{t.style.display="none"}}),{once:!0}),e.reset(),i.value=s.Title,o.value=s.Description,e.querySelector(`#todo-form-icon-${s.ToDoType}`).checked=!0,t.style.display="block"}))},new((a=void 0)||(a=Promise))((function(t,e){function n(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(e){var o;e.done?t(e.value):(o=e.value,o instanceof a?o:new a((function(t){t(o)}))).then(n,i)}o((u=u.apply(c,d||[])).next())}));var c,d,a,u}(this);if(null==s)return;const c=s.get("todo-form-title"),d=s.get("todo-form-description"),a=+s.get("todo-form-icon");m.Instance.Edit(this._id,c,d,a),this.SetData(c,d,a)},new((d=void 0)||(d=Promise))((function(t,e){function n(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(e){var o;e.done?t(e.value):(o=e.value,o instanceof d?o:new d((function(t){t(o)}))).then(n,i)}o((a=a.apply(s,c||[])).next())}));var s,c,d,a})),u.querySelector(".delete-btn").addEventListener("click",(()=>{m.Instance.Delete(this._id),c.removeChild(this._)})),c.appendChild(u),this._=c.querySelector("div:last-child")}SetData(t,e,n){(n||0===n)&&(this._imageElement.src=`./../../img/${n}.png`),t&&(this._titleElement.textContent=t),e&&(this._descriptionElement.textContent=e)}}},function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[String,String,Number,Number])],a);const u=a;class h{constructor(){this.list=[],this.Load()}static get Instance(){return null===h._instance&&(h._instance=new h),h._instance}Save(){localStorage.setItem("todolist",JSON.stringify(this.list.map((t=>this.ToJSON(t)))))}Load(){var t;this.list=JSON.parse(null!==(t=localStorage.getItem("todolist"))&&void 0!==t?t:"[]").map((t=>this.FromJSON(t)))}Clear(){this.list=[],this.Save()}ToJSON(t){return{_id:t.Id,_title:t.Title,_description:t.Description,_toDoType:t.ToDoType}}FromJSON(t){return new u(t._title,t._description,t._toDoType,t._id)}Add(t){this.list.push(t),this.Save()}Edit(t,...e){const n=this.list.find((e=>e.Id===t));n&&(n.Title=e[0],n.Description=e[1],n.ToDoType=e[2],this.Save())}Delete(t){const e=this.list.find((e=>e.Id===t));e&&(this.list.splice(this.list.indexOf(e),1),this.Save())}GenerateId(){return 0===this.list.length?0:this.list[this.list.length-1].Id+1}}h._instance=null;const m=h;m.Instance,document.getElementById("add-btn").addEventListener("click",(()=>{n.textContent="New Task",r.textContent="Add",e.addEventListener("submit",l),e.reset(),t.style.display="block"})),document.getElementById("close-btn").addEventListener("click",(()=>t.style.display="none")),window.addEventListener("dblclick",(e=>{e.target==t&&(t.style.display="none")}))})();